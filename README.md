# COVID-19
Example code for the analysis published in "Genome-wide Machine Learning Analysis of Loss of Smell and Taste in COVID-19" Reference:

This repository is for public access of example code used for the feature selection pipelines and machine learning analysis for the whole genome sequencing data presented in the above publication for prioritizing candidate variants and genes. The code files and scripts present are examples of the feature selection pipelines and machine learning analyses examined. They include the best performing feature selection pipelines, CMI-5, LR, DT-VI-1000-1; CMI-20, DT-VI-1000-10; and LR, gene transformation, CMI-20. This code could be used for a similar analysis on a like dataset. The bash scripts (CMI-20_DT-VI-1000-10.sh, CMI-5_LR_DT-VI-1000-1.sh, LR_GeneVarTransformation_CMI-20.sh) are intended as an example of how all scripts could be ran together and for examples of how to run individual scripts with the required arguments. Within all the script files, there are comments for parameters, variables, and options tested in the study that can be tuned or also teasted in another dataset. The input is a vcf file into the datasetCreator.V4.2.py script, that will transform the variants to the machine learning (ML) dataset. The targets_file.txt file is an example on how the targets or the response variable needs to be supplied. After the ML datasaet is created, any of the feature selection algorithms can be used. Each script included in the pipelines are going to have their own output file for troubleshooting if needed. The ML analysis with have three output files for each model including the model fit .rds object and the variable importance (VI) analysis output in .csv and .pdf format. The overall code output will be to stdout or to a log file if specified as well as .csv files for training and test set performance. Please see the publication for a desciption of additional variant filtering, analysis details, and rationale. The example.vcf.gz file is for testing the datasetCreator.V4.2.py script and any feature selection algorithms but is limited in samples and variants potentially resultsing in errors with filtering pipelines.

